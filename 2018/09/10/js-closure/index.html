<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Javascript Closure란? | Lazy Developer</title><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/highlights/dracula.css"><link rel="canonical" href="https://y0c.github.io/2018/09/10/js-closure/">
<meta name="description" content="javascript 를 공부하다보면 closure라는 개념을 자연스럽게 접하게 된다.이번 포스팅에선 Closure에 대해서 좀 더 깊게 다뤄보려고 한다.  Closure 개념에 앞서서 먼저 함수에 대해서 언어별로 처리하고 있는 방법에 대해서…">
<meta name="keywords" content="Closure,javascript">
<meta property="og:type" content="article">
<meta property="og:title" content="Javascript Closure란?">
<meta property="og:url" content="https://y0c.github.io/2018/09/10/js-closure/">
<meta property="og:site_name" content="Lazy Developer">
<meta property="og:description" content="javascript 를 공부하다보면 closure라는 개념을 자연스럽게 접하게 된다.이번 포스팅에선 Closure에 대해서 좀 더 깊게 다뤄보려고 한다.  Closure 개념에 앞서서 먼저 함수에 대해서 언어별로 처리하고 있는 방법에 대해서…">
<meta property="og:image" content="https://y0c.github.io/images/js.png">
<meta property="og:updated_time" content="2018-09-09T21:33:25.200Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Javascript Closure란?">
<meta name="twitter:description" content="javascript 를 공부하다보면 closure라는 개념을 자연스럽게 접하게 된다.이번 포스팅에선 Closure에 대해서 좀 더 깊게 다뤄보려고 한다.  Closure 개념에 앞서서 먼저 함수에 대해서 언어별로 처리하고 있는 방법에 대해서…">
<meta name="twitter:image" content="https://y0c.github.io/images/js.png"><meta property="article:author" content="HoSung"><meta property="twitter:label1" content="Published at"><meta property="twitter:data1" content="2018-09-10 04:50:35"><meta property="twitter:label2" content="Written by"><meta property="twitter:data2" content="HoSung"><link rel="icon" href="/images/logo.svg"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Lazy Developer"><script>(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-112029921-1', 'auto');
ga('send', 'pageview');</script></head><body itemscope="" itemtype="https://schema.org/WebPage"><nav class="menu" id="menu"><div class="menu-inner"><div class="menu__left-area"><div class="menu__item"><a class="menu__item__link menu__item__link--brand" href="/" title="Home" rel="home"><img class="menu__item__link--brand__image" src="/images/logo.svg" alt="Lazy Developer"><span class="menu__item__link--brand__label">Lazy Developer</span></a></div></div><div class="menu__right-area"><div class="menu__item"><a class="menu__item__link" href="/">Home</a></div><div class="menu__item"><a class="menu__item__link" href="/about">About</a></div><div class="menu__item"><a class="menu__item__link" href="/archives">Archives</a></div></div></div></nav><div class="page-background"></div><div class="content-container"><div class="content-outer"><div class="content-inner" itemscope="" itemtype="https://schema.org/Blog"><article class="article" id="article" itemscope="" itemtype="https://schema.org/BlogPosting"><h1 class="article__title" itemprop="headline">Javascript Closure란?</h1><div class="article__meta"><time class="article__meta__time" datetime="2018-09-09T19:50:35.000Z" itemprop="datePublished">2018-09-10 04:50:35</time><div class="article__meta__categories"><a class="article__meta__categories__item" href="/categories/Javascript/">Javascript</a></div></div><div class="article__contents"><img src="/images/js.png"><p>javascript 를 공부하다보면 closure라는 개념을 자연스럽게 접하게 된다.<br>이번 포스팅에선 Closure에 대해서 좀 더 깊게 다뤄보려고 한다. </p>
<p>Closure 개념에 앞서서 먼저 <code>함수</code>에 대해서 언어별로 처리하고 있는 방법에 대해서 논해보도록 하자.</p>
<p>함수는 언어별로 사용되는 형태의 차이가 있다.<br>예를들면, Java와 같은 언어에서는 함수(메소드)를 <code>문(Statement)</code> 처럼 취급한다.<br>다른 예를보면 C, Javascript, Python, Kotlin, Swift 와 같은 언어를 보면 함수도 일반적인 <code>값(Value)</code>처럼 취급한다. </p>
<h2 id="1급-객체-first-class-citizens"><a href="#1급-객체-first-class-citizens" class="headerlink" title="1급 객체(first-class citizens)"></a>1급 객체(first-class citizens)</h2><p>1급 객체는 일반적으로 위에서 설명한 함수를 <code>값(Value)</code>처럼 취급하는 언어들에 해당된다. </p>
<p>1급 객체의 조건은 다음과 같다. </p>
<ul>
<li>변수나 데이터 구조안에 담을 수 있다. </li>
<li>파라미터로 전달할 수 있다. </li>
<li>반환값으로 사용할 수 있다. </li>
</ul>
<p>여기서 런타임 시에 함수를 생성할 수 있는지 여부에 따라 <code>2급 객체</code> 로 분류하기도 한다. </p>
<h2 id="함수를-1급-객체로-다루는-언어들의-특징"><a href="#함수를-1급-객체로-다루는-언어들의-특징" class="headerlink" title="함수를 1급 객체로 다루는 언어들의 특징"></a>함수를 1급 객체로 다루는 언어들의 특징</h2><p>함수를 1급 객체로 다루는 언어들의 특징에 대해서 잠시 알아보자. </p>
<ul>
<li>런타임시에 동적으로 함수를 생성가능  ex) lambda</li>
<li>함수를 <code>값(Value)</code>로 취급 </li>
<li>함수가 생성된 환경을 기억하고 있다. </li>
</ul>
<p>아래 간단한 예시를 보자<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeFunc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//자유변수(Free Variable)</span></span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">'Mozilla'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Closure</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">displayName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//지역변수(Local Variable)</span></span><br><span class="line">        <span class="keyword">var</span> v1 = <span class="string">'test'</span>;</span><br><span class="line">        alert(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> displayName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>함수가 런타임시에 동적으로 함수를 생성하는 예제이다.<br>여기서 몇가지 개념에 대해 정리하려고 한다.<br>런타임시에 함수를 생성할 수 있는 언어들은 생성된 환경(Context)를 기억하고 있다.<br>함수를 <code>문(Statement)</code>으로 취급하는 언어들은 기본적으로 Global 과 local영역을 참조했다면 참조할 영역이 늘어난 셈이다. <code>displayName</code> 함수 입장에서 상위 함수인 <code>makeFunc</code>의 name도 참조할 수 있어야한다. 여기서 local영역이 아닌 상위 함수의 변수들을 <code>자유변수(Free Variable)</code> 이라고 한다.  그리고 이 자유변수들을 가르키는 함수가 <code>Closure</code>이다. </p>
<p>위 예제에서는 name 자유변수를 사용하고 있는 displayName이 Closure</p>
<h3 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h3><blockquote>
<p>함수가 생성된 환경 Javascript에서는 Lexical Environment라고도 한다.  </p>
</blockquote>
<h3 id="자유변수-Free-Variable"><a href="#자유변수-Free-Variable" class="headerlink" title="자유변수(Free Variable)"></a>자유변수(Free Variable)</h3><blockquote>
<p>local영역이 아닌 Context 영역의 변수들<br>즉, local에 존재하지 않는 모든 변수를 뜻함</p>
</blockquote>
<h3 id="Closure"><a href="#Closure" class="headerlink" title="Closure"></a>Closure</h3><blockquote>
<p>독립적인 자유변수를 가리키는 함수<br>(자유변수를 가두는 영역)</p>
</blockquote>
<p>정리하자면, Closure란 JS에 국한된 개념이 아니라 런타임에 함수가 만들어지는 언어에서는 <code>자유변수</code> 라는 개념이 존재하고 <code>자유변수</code>가 존재하면 필연적으로 <code>Closure</code> 가 발생하게 된다. </p>
<h2 id="Closure와-성능"><a href="#Closure와-성능" class="headerlink" title="Closure와 성능"></a>Closure와 성능</h2><p>일반적으로 함수의 지역변수는 함수가 끝남과 동시에 메모리에서 해제된다.<br>클로저는 위에서 언급했듯이 함수가 생성된 환경(Context)을 기억하고 변수(자유변수)를 참조할 수 있다. 그리고 자유변수를 한 번 이라도 참조했다면 메모리에서 해제되지 않는다. 그러므로 Closure가 필요하지 않은 상황에서 함수내에 함수를 작성하는것은 메모리 소비 측면에서 부정적인 영향을 미친다. </p>
<h2 id="Closure와-Scope"><a href="#Closure와-Scope" class="headerlink" title="Closure와 Scope"></a>Closure와 Scope</h2><p>ES6이전의 JS에서는 오직 function만의 새로운 scope를 생성했다.<br>아래 예시를 보도록 하자.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHelp</span>(<span class="params">help</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'help'</span>).innerHTML = help;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setupHelp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> helpText = [</span><br><span class="line">        &#123;<span class="string">'id'</span>: <span class="string">'email'</span>, <span class="string">'help'</span>: <span class="string">'Your e-mail address'</span>&#125;,</span><br><span class="line">        &#123;<span class="string">'id'</span>: <span class="string">'name'</span>, <span class="string">'help'</span>: <span class="string">'Your full name'</span>&#125;,</span><br><span class="line">        &#123;<span class="string">'id'</span>: <span class="string">'age'</span>, <span class="string">'help'</span>: <span class="string">'Your age (you must be over 16)'</span>&#125;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; helpText.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> item = helpText[i];</span><br><span class="line">        <span class="built_in">document</span>.getElementById(item.id).onfocus = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            showHelp(item.help);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>대충 훑어보기에는 코드에 문제가 없어보일 수 도 있다.<br>하지만 위 코드는 의도한대로 작동하지 않는다. 모두 age에 관한 도움말을 보여주게된다.<br>코드를 분석해보면 onfocus에는 클로저가 연결되어있다. loop문을 통해 3개의 클로저가 생성되지만 하나의 자유변수(item)를 공유하기 때문이다.<br>(var은 scope 범위가 함수이기 때문에)</p>
<p>해결방법은 클로저를 하나더 생성하는 것이다.<br>클로저를 하나 더 생성함으로 동일한 item이 아닌 각각 다른 item을 가리키게 된다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; helpText.length; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(item.id).onfocus = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            showHelp(item.help);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)(helpText[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>위와같은 방법이 좀 복잡하다고 느껴진다면 <code>let</code>을 사용하도록 하자.<br>let은 유효범위가 block 즉, 중괄호 이므로 클로저를 추가적으로 만들지 않아도 의도한대로 동작하게 된다. </p>
<h3 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h3><p><a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Closures" rel="external nofollow noopener noreferrer" target="_blank">https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Closures</a></p>
</div><div class="article__tags"><a class="article__tags__item" href="/tags/Closure/">Closure</a><a class="article__tags__item" href="/tags/javascript/">javascript</a></div><div class="article__author" itemscope="" itemprop="author" itemtype="https://schema.org/Person"><img class="article__author__image" src="/images/profile.jpg" alt="HoSung"><a class="article__author__link" title="About HoSung" rel="author">HoSung</a><p class="article__author__desc">Web Developer &amp; Student</p><div class="article__author__socials"><a class="article__author__socials__item" href="http://github.com/y0c" title="github" target="_blank" rel="external nofollow noopener noreferrer"><i class="fa fa-github"></i></a><a class="article__author__socials__item" href="/atom.xml" title="rss" target="_blank"><i class="fa fa-rss"></i></a></div><meta itemprop="name" content="HoSung"></div><div class="sharer" id="sharer"><div class="sharer-inner"><div class="sharer__right"><button class="sharer__item" id="sharer-facebook"><i class="fa fa-facebook-official"></i></button><button class="sharer__item" id="sharer-twitter"><i class="fa fa-twitter"></i></button><button class="sharer__item" id="sharer-pinterest"><i class="fa fa-pinterest"></i></button><button class="sharer__item" id="sharer-pocket"><i class="fa fa-get-pocket"></i></button></div></div></div><!-- Disqus Code--><div id="disqus_thread"></div><script>(function() {
  var d = document, s = d.createElement('script');
  s.src = '//lazy-developer.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Enable JavaScript to see comments.</noscript><!-- Meta Tags for Structured Data--><meta itemprop="dateModified" content="2018-09-09T21:33:25.200Z"><meta itemprop="articleBody" content="javascript 를 공부하다보면 closure라는 개념을 자연스럽게 접하게 된다.이번 포스팅에선 Closure에 대해서 좀 더 깊게 다뤄보려고 한다. 
Closure 개념에 앞서서 먼저 함수에 대해서 언어별로 처리하고 있는 방법에 대해서 논해보도록 하자.
함수는 언어별로 사용되는 형태의 차이가 있다.예를들면, Java와 같은 언어에서는..."><meta itemprop="url" content="https://y0c.github.io/2018/09/10/js-closure/"><meta itemprop="mainEntityOfPage" content="https://y0c.github.io/2018/09/10/js-closure/"><div itemscope="" itemtype="https://schema.org/Organization" itemprop="publisher"><meta itemprop="name" content="Lazy Developer"><div itemscope="" itemprop="logo" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://y0c.github.io/images/logo.svg"></div></div><div itemscope="" itemtype="https://schema.org/ImageObject" itemprop="image"><meta itemprop="contentUrl" content="https://y0c.github.io/images/js.png"><meta itemprop="url" content="https://y0c.github.io/images/js.png"><meta itemprop="width"><meta itemprop="height"></div></article><section class="related-posts"><h3>Related posts</h3><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/08/10/js-decorator/"><div class="related-posts__item__background" style="background-image:url('/images/js.png');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">Javascript Decorator Pattern</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/09/09/js-generator/"><div class="related-posts__item__background" style="background-image:url('/images/js.png');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">JS의 Generator와 Iterator</span></a></div></section></div></div></div><footer id="footer"><div class="widgets"><div class="widgets-inner"><!-- Jade doesn't support dynamic inclusion with `each`.--><!-- So, I just hard coded the file names that will be included.--><div class="widgets__item"><h3 class="widgets__item__heading">Recent posts</h3><ul class="recent-posts"><li class="recent-posts__item"><a href="/2018/10/21/redis-cluster/">Redis Cluster 구축하기</a></li><li class="recent-posts__item"><a href="/2018/10/20/Docker-Private-Registry/">Docker Private Registry 구축하기</a></li><li class="recent-posts__item"><a href="/2018/09/28/centos7-mail-server/">CentOS 7 Mail Server 구축하기 Postfix + Dovecot</a></li><li class="recent-posts__item"><a href="/2018/09/27/tmux-tutorial/">Tmux Tutorial 정리</a></li><li class="recent-posts__item"><a href="/2018/09/10/semantic-ui-react-theme/">Semantic-Ui-React Theme Customizing</a></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Archives</h3><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">2</span></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Categories</h3><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tmux/">Tmux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/serverless/">serverless</a><span class="category-list-count">1</span></li></ul></div></div></div><p class="copyright"><small>© 2018 HoSung<br>Powered by <a href="https://hexo.io" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a>, Theme by <a href="https://github.com/hyunseob" rel="external nofollow noopener noreferrer" target="_blank">HyunSeob</a></small></p></footer><script src="/js/sharer.min.js"></script></body></html>